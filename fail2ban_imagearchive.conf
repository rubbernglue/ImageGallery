# Fail2Ban filter configuration for ImageArchive
# Place this file in: /etc/fail2ban/filter.d/imagearchive.conf

[Definition]

# Fail2Ban filter to detect failed login attempts in ImageArchive auth log
# Matches log entries like:
# 2025-12-11 22:30:15 FAILED: user=admin ip=192.168.1.100

failregex = ^.* FAILED: user=.* ip=<HOST>$

# Ignore successful logins
ignoreregex = ^.* SUCCESS:

# Date format matching the Python logging format
datepattern = ^%%Y-%%m-%%d %%H:%%M:%%S
